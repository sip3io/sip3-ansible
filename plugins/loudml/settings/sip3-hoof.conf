server {
        listen       80 default_server;
        server_name  _;
        root         /usr/share/nginx/html;

        gzip_types    text/plain application/javascript application/x-javascript text/javascript text/xml text/css;
        gzip on;

        access_log  /var/log/nginx/sip3-hoof_access.log  main;
        error_log  /var/log/nginx/sip3-hoof_error.log warn;

        location ~ /\. {
            deny all;
        }

        location /api {
            proxy_pass http://sip3-twig:8080;
        }

        location / {
            try_files $uri $uri/ /index.html;
        }

        location /grafana {
            rewrite ^/grafana/(.*)$ /$1 break;
            proxy_set_header   Host localhost:3000;
            proxy_pass http://sip3-grafana:3000;
        }

	location /chronograf {
	    proxy_set_header   Host $host;
	    proxy_pass http://sip3-chronograf:8888;
	}

	location ^~ /chronograf/loudml/api/ {
	    rewrite /chronograf/loudml/api/(.*) /$1 break;
	    proxy_ignore_client_abort on;
	    proxy_set_header Host $host;
	    proxy_pass http://sip3-loudml:8077;
	}

        error_page 404 /404.html;
            location = /40x.html {
        }

        error_page 500 502 503 504 /50x.html;
            location = /50x.html {
        }
}

